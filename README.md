# IO-latency-tracing
Simple program using eBPF to trace IO latency.

## Usage
```
make
sudo ./iolatency.out <print time interval>
```

## IO workload generation with ```fio```
```
sudo fio --filename=./text.txt --rw=read --direct=1 --bs=1M --ioengine=libaio --runtime=5 --numjobs=1 --time_based --group_reporting --name=seq_read --size=1M --iodepth=16
```

## Results
### No workflow generated by fio
     usecs               : count    distribution
         0 -> 1          : 0        |                                        |
         2 -> 3          : 0        |                                        |
         4 -> 7          : 0        |                                        |
         8 -> 15         : 0        |                                        |
        16 -> 31         : 0        |                                        |
        32 -> 63         : 0        |                                        |
        64 -> 127        : 1        |****                                    |
       128 -> 255        : 2        |********                                |
       256 -> 511        : 8        |********************************        |
       512 -> 1023       : 10       |****************************************|
      1024 -> 2047       : 2        |********                                |
      2048 -> 4095       : 1        |****                                    |
      4096 -> 8191       : 1        |****                                    |

### With workflow generated by fio
     usecs               : count    distribution
         0 -> 1          : 0        |                                        |
         2 -> 3          : 0        |                                        |
         4 -> 7          : 0        |                                        |
         8 -> 15         : 0        |                                        |
        16 -> 31         : 0        |                                        |
        32 -> 63         : 3        |                                        |
        64 -> 127        : 0        |                                        |
       128 -> 255        : 0        |                                        |
       256 -> 511        : 66       |                                        |
       512 -> 1023       : 56782    |****************************************|
      1024 -> 2047       : 31805    |**********************                  |
      2048 -> 4095       : 176      |                                        |
      4096 -> 8191       : 86       |                                        |
